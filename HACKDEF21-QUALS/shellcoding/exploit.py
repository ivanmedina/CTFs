from pwn import *
import time
binf = ELF("hacknote")
# libc = binf.libc
libc = ELF("libc_32.so.6")

gs = '''
'''

def start():
    if args.GDB:
        return gdb.debug(binf.path, gdbscript=gs)
    else:
        return process(binf.path)
        # return remote("chall.pwnable.tw", 10101)
        # return remote("challs.m0lecon.it",1907)

def add(size, payload):
	p.sendline('1')
	p.sendline(str(size))
	p.sendline(str(payload))

def delete(index):
	p.sendline('2')
	p.sendline(str(index))

def show(index):
	p.recv()
	p.sendline('3')
	p.sendline(str(index))
	p.recvuntil(b'Index :')
	print(p.recvuntil('\n').replace(b'\n',b''))

def exit():
	p.sendline('4')

# context.log_level = "DEBUG"
context.aslr = False

print(binf.plt)

p=start()

add(8,'AAAAAA')
add(8,'BBBBBB')
pause()
show(0)
show(1)
# delete(0)
# show(0)
# delete(1)
# pause()
p.interactive()
